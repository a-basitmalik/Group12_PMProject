<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PM Standards Explorer ‚Äî Project Aurora</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/elasticlunr/elasticlunr.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>

  <style>
    /* ==============================================
       PROFESSIONAL REDESIGN: MODERN, CLEAN, USER-FRIENDLY
       ============================================== */

    :root {
      /* Professional color palette */
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --primary-light: #4895ef;
      --secondary: #7209b7;
      --accent: #f72585;
      --success: #4cc9f0;
      
      /* Neutral tones */
      --bg-primary: #0f1419;
      --bg-secondary: #1a2026;
      --bg-surface: #242c33;
      --bg-card: #2a333c;
      
      /* Text colors */
      --text-primary: #f8fafc;
      --text-secondary: #cbd5e1;
      --text-muted: #94a3b8;
      
      /* UI elements */
      --border: rgba(255, 255, 255, 0.08);
      --border-light: rgba(255, 255, 255, 0.12);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4);
      --radius: 8px;
      --radius-lg: 12px;
      --transition: all 0.2s ease;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      color: var(--text-secondary);
      background-color: var(--bg-primary);
      line-height: 1.5;
    }

    /* Layout */
    .app-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Navigation */
    .sidebar {
      width: 260px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
    }

    .sidebar-header {
      padding: 24px 20px 16px;
      border-bottom: 1px solid var(--border);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--text-primary);
      font-weight: 700;
      font-size: 18px;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 14px;
    }

    .nav-section {
      padding: 20px 0;
    }

    .nav-title {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      padding: 0 20px 12px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: var(--transition);
      border-left: 3px solid transparent;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.03);
      color: var(--text-primary);
    }

    .nav-item.active {
      background: rgba(67, 97, 238, 0.1);
      color: var(--primary-light);
      border-left-color: var(--primary);
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: 0;
      min-height: 100vh;
    }

    /* Top Bar */
    .top-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 90;
    }

    .page-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
    }

    .user-actions {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border-radius: var(--radius);
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-secondary {
      background: var(--bg-surface);
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--bg-card);
      color: var(--text-primary);
    }

    .btn-outline {
      background: transparent;
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-outline:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-primary);
    }

    /* Page Content */
    .page-content {
      padding: 32px;
      max-width: 1400px;
    }

    /* Card Components */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .card-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card-body {
      padding: 24px;
    }

    .card-footer {
      padding: 16px 24px;
      border-top: 1px solid var(--border);
      background: rgba(0, 0, 0, 0.1);
    }

    /* Grid Layout */
    .grid {
      display: grid;
      gap: 24px;
    }

    .grid-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    .grid-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .form-control {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text-primary);
      font-size: 14px;
      transition: var(--transition);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    /* Search Results */
    .search-results {
      max-height: 400px;
      overflow-y: auto;
    }

    .result-item {
      padding: 16px;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .result-item:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    .result-title {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .result-meta {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .result-snippet {
      font-size: 14px;
      color: var(--text-secondary);
    }

    /* Document Viewer */
    .viewer-container {
      height: 500px;
      overflow-y: auto;
      background: var(--bg-surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 20px;
      font-size: 15px;
      line-height: 1.6;
    }

    /* Viewer Controls */
    .viewer-controls {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      background: var(--bg-surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .viewer-nav {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .page-indicator {
      font-size: 14px;
      color: var(--text-muted);
      min-width: 100px;
      text-align: center;
    }

    /* Comparison */
    .comparison-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }

    .comparison-box {
      height: 300px;
      overflow-y: auto;
      background: var(--bg-surface);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 16px;
      font-size: 14px;
      line-height: 1.5;
    }

    /* Dashboard Stats */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
    }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 14px;
      color: var(--text-muted);
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin-bottom: 24px;
    }

    .tab {
      padding: 12px 20px;
      font-weight: 500;
      color: var(--text-muted);
      cursor: pointer;
      transition: var(--transition);
      border-bottom: 2px solid transparent;
    }

    .tab.active {
      color: var(--primary-light);
      border-bottom-color: var(--primary);
    }

    .tab:hover:not(.active) {
      color: var(--text-secondary);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Utility Classes */
    .text-center { text-align: center; }
    .text-primary { color: var(--text-primary); }
    .text-muted { color: var(--text-muted); }
    .mb-0 { margin-bottom: 0; }
    .mb-1 { margin-bottom: 8px; }
    .mb-2 { margin-bottom: 16px; }
    .mb-3 { margin-bottom: 24px; }
    .mt-1 { margin-top: 8px; }
    .mt-2 { margin-top: 16px; }
    .mt-3 { margin-top: 24px; }
    .d-flex { display: flex; }
    .align-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-1 { gap: 8px; }
    .gap-2 { gap: 16px; }
    .gap-3 { gap: 24px; }

    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-surface);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-light);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }

    /* Document content styling */
    #bookContent {
      line-height: 1.6;
      font-size: 15px;
    }

    #bookContent mark {
      background: linear-gradient(90deg, rgba(167,121,255,0.3), rgba(14,208,226,0.2));
      padding: 2px 4px;
      border-radius: 4px;
      color: var(--text-primary);
      font-weight: 600;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .grid-3 {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 992px) {
      .sidebar {
        width: 80px;
      }
      
      .sidebar-header .logo-text,
      .nav-item .nav-text,
      .nav-title {
        display: none;
      }
      
      .main-content {
        margin-left: 80px;
      }
      
      .comparison-container {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .grid-2,
      .grid-3 {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .page-content {
        padding: 20px;
      }
      
      .top-bar {
        padding: 16px 20px;
      }
      
      .viewer-controls {
        flex-direction: column;
        align-items: stretch;
      }
    }

    /* Page-specific styles */
    .page {
      display: none;
    }
    
    .page.active {
      display: block;
    }
    
    /* Welcome page */
    .welcome-hero {
      text-align: center;
      padding: 60px 0;
      background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
      border-radius: var(--radius-lg);
      margin-bottom: 40px;
    }
    
    .welcome-title {
      font-size: 36px;
      font-weight: 800;
      color: var(--text-primary);
      margin-bottom: 16px;
    }
    
    .welcome-subtitle {
      font-size: 18px;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto 32px;
    }
    
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      margin-top: 40px;
    }
    
    .feature-card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      text-align: center;
      border: 1px solid var(--border);
      transition: var(--transition);
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .feature-icon {
      width: 60px;
      height: 60px;
      background: rgba(67, 97, 238, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 16px;
      color: var(--primary);
      font-size: 24px;
    }
    
    .feature-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    .feature-description {
      color: var(--text-secondary);
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar Navigation -->
    <nav class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-icon">PM</div>
          <span class="logo-text">Standards Explorer</span>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Main</div>
        <a href="#" class="nav-item active" data-page="dashboard">
          <div class="nav-icon">üìä</div>
          <span class="nav-text">Dashboard</span>
        </a>
        <a href="#" class="nav-item" data-page="repository">
          <div class="nav-icon">üìÅ</div>
          <span class="nav-text">Repository</span>
        </a>
        <a href="#" class="nav-item" data-page="viewer">
          <div class="nav-icon">üìñ</div>
          <span class="nav-text">Document Viewer</span>
        </a>
        <a href="#" class="nav-item" data-page="search">
          <div class="nav-icon">üîç</div>
          <span class="nav-text">Search</span>
        </a>
        <a href="#" class="nav-item" data-page="compare">
          <div class="nav-icon">‚öñÔ∏è</div>
          <span class="nav-text">Compare</span>
        </a>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Tools</div>
        <a href="#" class="nav-item" data-page="process">
          <div class="nav-icon">üõ†Ô∏è</div>
          <span class="nav-text">Process Generator</span>
        </a>
        <a href="#" class="nav-item" data-page="scenarios">
          <div class="nav-icon">üéØ</div>
          <span class="nav-text">Scenarios</span>
        </a>
        <a href="#" class="nav-item" data-page="bookmarks">
          <div class="nav-icon">‚≠ê</div>
          <span class="nav-text">Bookmarks</span>
        </a>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Settings</div>
        <!-- <a href="#" class="nav-item" data-page="export">
          <div class="nav-icon">üì§</div>
          <span class="nav-text">Export</span>
        </a> -->
        <a href="#" class="nav-item" id="githubLink">
          <div class="nav-icon">üîó</div>
          <span class="nav-text">GitHub Repo</span>
        </a>
      </div>
    </nav>
    
    <!-- Main Content -->
    <main class="main-content">
      <!-- Top Bar -->
      <header class="top-bar">
        <h1 class="page-title" id="currentPageTitle">Dashboard</h1>
        <div class="user-actions">
          <button class="btn btn-outline" id="exportReadme">Export README</button>
          <button class="btn btn-primary" id="downloadWBS">Download WBS</button>
        </div>
      </header>
      
      <!-- Page Content -->
      <div class="page-content">
        <!-- Dashboard Page -->
        <div class="page active" id="dashboard">
          <div class="welcome-hero">
            <h1 class="welcome-title">PM Standards Explorer</h1>
            <p class="welcome-subtitle">A comprehensive tool for comparing project management standards, generating processes, and tailoring methodologies to your specific needs.</p>
            <div class="d-flex justify-center gap-2">
              <button class="btn btn-primary" data-page="repository" style="margin-left: 350px;">Get Started</button>
              <button class="btn btn-outline" data-page="scenarios">Explore Scenarios</button>
            </div>
          </div>
          
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="docCount">0</div>
              <div class="stat-label">Standards Uploaded</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="bookmarkCount">0</div>
              <div class="stat-label">Bookmarks</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">3</div>
              <div class="stat-label">Scenario Templates</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="searchCount">0</div>
              <div class="stat-label">Search Results</div>
            </div>
          </div>
          
          <div class="grid grid-3">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üìÅ Repository</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Upload and manage your PM standards documents (PDF, TXT, HTML).</p>
                <button class="btn btn-primary mt-2" data-page="repository">Manage Documents</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üìñ Document Viewer</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Read and navigate through your uploaded documents with full functionality.</p>
                <button class="btn btn-primary mt-2" data-page="viewer">View Documents</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üîç Search</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Search across all uploaded standards with advanced filtering.</p>
                <button class="btn btn-primary mt-2" data-page="search">Search Standards</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">‚öñÔ∏è Compare</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Compare standards side-by-side and identify similarities and differences.</p>
                <button class="btn btn-primary mt-2" data-page="compare">Start Comparison</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üõ†Ô∏è Process Generator</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Generate custom WBS and process flows based on your project needs.</p>
                <button class="btn btn-primary mt-2" data-page="process">Generate Process</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üéØ Scenarios</h3>
              </div>
              <div class="card-body">
                <p class="text-muted">Explore tailored processes for different project scenarios.</p>
                <button class="btn btn-primary mt-2" data-page="scenarios">View Scenarios</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Repository Page -->
        <div class="page" id="repository">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üìÅ Standards Repository</h2>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label class="form-label">Upload Standards Documents</label>
                <input type="file" id="fileInput" class="form-control" multiple accept=".pdf,.txt,.html,.htm,text/plain">
                <div class="text-muted mt-1">Supported formats: PDF, TXT, HTML</div>
              </div>
              
              <div class="mt-3">
                <h3 class="text-primary mb-2">Uploaded Documents</h3>
                <div id="fileList" class="search-results">
                  <div class="text-muted text-center py-4">No documents uploaded yet</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Document Viewer Page -->
        <div class="page" id="viewer">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üìñ Document Viewer</h2>
            </div>
            <div class="card-body">
              <div class="viewer-controls">
                <div class="form-group" style="flex: 1; min-width: 200px;">
                  <select id="docSelect" class="form-control">
                    <option value="">-- Select a document --</option>
                  </select>
                </div>
                
                <div class="viewer-nav">
                  <button class="btn btn-outline" id="prevPage" title="Previous Page">‚Üê Prev</button>
                  <div class="page-indicator" id="currentPage">- / -</div>
                  <button class="btn btn-outline" id="nextPage" title="Next Page">Next ‚Üí</button>
                </div>
                
                <div class="d-flex gap-2">
                  <button class="btn btn-outline" id="bookmarkBtn" title="Bookmark this page">‚≠ê Bookmark</button>
                  <button class="btn btn-outline" id="copyDeepLink" title="Copy link to this view">üîó Copy Link</button>
                </div>
              </div>
              
              <div id="bookContent" class="viewer-container" style="height: 600px;">
                <div class="text-muted text-center py-4">
                  Select a document from the dropdown to start reading
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Search Page -->
        <div class="page" id="search">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üîç Search Across Standards</h2>
            </div>
            <div class="card-body">
              <div class="form-group">
                <div class="d-flex gap-2">
                  <input type="text" id="searchBox" class="form-control" placeholder="Search for risk management, stakeholder analysis, etc.">
                  <button class="btn btn-primary" id="searchBtn">Search</button>
                </div>
              </div>
              
              <div class="mt-3">
                <h3 class="text-primary mb-2">Search Results</h3>
                <div id="searchResults" class="search-results">
                  <div class="text-muted text-center py-4">Enter a search term to find content across your standards</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Compare Page -->
        <div class="page" id="compare">
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">‚öñÔ∏è Document Comparison</h2>
              </div>
              <div class="card-body">
                <div class="form-group">
                  <label class="form-label">Select Content for Comparison</label>
                  <div class="d-flex gap-2">
                    <button class="btn btn-secondary" id="setA">Set as A</button>
                    <button class="btn btn-secondary" id="setB">Set as B</button>
                    <button class="btn btn-primary" id="compareBtn">Compare</button>
                  </div>
                  <div id="selectionPreview" class="mt-2 text-sm"></div>
                </div>
                
                <div class="comparison-container mt-3">
                  <div class="comparison-box" id="compareA">
                    <div class="text-muted">A ‚Äî Select content from a document or search result</div>
                  </div>
                  <div class="comparison-box" id="compareB">
                    <div class="text-muted">B ‚Äî Select content from a document or search result</div>
                  </div>
                </div>
                
                <div class="mt-2">
                  <button class="btn btn-outline" id="openCompareLink">Open Comparison Source</button>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üí° Insights</h2>
              </div>
              <div class="card-body">
                <div id="insightsPanel" class="viewer-container" style="height: 300px;">
                  <div class="text-muted">Compare documents A and B to see insights about similarities and differences</div>
                </div>
                <div class="d-flex gap-2 mt-2">
                  <button class="btn btn-primary" id="computeInsights">Compute Insights</button>
                  <button class="btn btn-secondary" id="exportInsights">Export Insights</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Process Generator Page -->
        <div class="page" id="process">
          <div class="grid grid-2">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">üõ†Ô∏è Process & WBS Generator</h2>
              </div>
              <div class="card-body">
                <div class="form-group">
                  <label class="form-label">Project Name</label>
                  <input type="text" id="projectName" class="form-control" placeholder="e.g., Mobile App Upgrade">
                </div>
                
                <div class="d-flex gap-2">
                  <button class="btn btn-primary" id="generateProcess">Generate Process</button>
                  <button class="btn btn-secondary" id="downloadProcess">Download Process</button>
                </div>
                
                <div class="mt-3">
                  <h3 class="text-primary mb-2">Process Output</h3>
                  <div id="processOutput" class="text-muted">
                    Generate a process to see the output here
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">ü™ú WBS Preview</h2>
              </div>
              <div class="card-body">
                <div id="wbsPreview" class="viewer-container">
                  <div class="text-muted">A WBS will be generated from your process</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Scenarios Page -->
        <div class="page" id="scenarios">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">üéØ Scenario-Based Process Tailoring</h2>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label class="form-label">Select Project Scenario</label>
                <select id="scenarioSelect" class="form-control">
                  <option value="">Select a scenario</option>
                  <option value="software">Custom Software Development (Agile-lite)</option>
                  <option value="innovation">Innovative Product Development (R&D, Stage-Gate)</option>
                  <option value="government">Large Government Project (Predictive, High Governance)</option>
                </select>
              </div>
              
              <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-primary" id="generateScenarioProcess">Generate Tailored Process</button>
                <button class="btn btn-secondary" id="generateAllScenarios">Generate All 3</button>
                <button class="btn btn-secondary" id="downloadProcessDoc">Download Document</button>
                <button class="btn btn-secondary" id="exportDiagram">Export Diagram (SVG)</button>
              </div>
              
              <div class="mt-3">
                <h3 class="text-primary mb-2">Scenario Output</h3>
                <div id="scenarioOutput" class="text-muted">
                  Select a scenario and generate a process to see the output
                </div>
              </div>
              
              <div class="mt-3">
                <h3 class="text-primary mb-2">Scenario Details</h3>
                <div id="phase2Details" class="viewer-container">
                  <div class="text-muted">Generate a scenario to see process details, justification, and references</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Bookmarks Page -->
        <div class="page" id="bookmarks">
          <div class="card">
            <div class="card-header d-flex justify-between align-center">
              <h2 class="card-title">‚≠ê Bookmarks & Saved Views</h2>
              <div class="d-flex gap-2">
                <button class="btn btn-secondary" id="exportBookmarks">Export</button>
                <button class="btn btn-secondary" id="importBookmarks">Import</button>
                <button class="btn btn-outline" id="clearBookmarks">Clear All</button>
              </div>
            </div>
            <div class="card-body">
              <div id="bookmarksList" class="search-results">
                <div class="text-muted text-center py-4">No bookmarks saved yet</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Export Page -->
        <div class="page" id="export">
          <div class="grid grid-3">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üìÑ Documents</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export your process documents and WBS</p>
                <button class="btn btn-primary" id="downloadWBS2">Download WBS</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üìä Insights</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export comparison insights and analysis</p>
                <button class="btn btn-primary" id="exportInsights2">Export Insights</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">‚≠ê Bookmarks</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export your saved bookmarks</p>
                <button class="btn btn-primary" id="exportBookmarks2">Export Bookmarks</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üõ†Ô∏è Processes</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export generated processes</p>
                <button class="btn btn-primary" id="downloadProcess2">Download Process</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üéØ Scenarios</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export scenario documents and diagrams</p>
                <button class="btn btn-primary" id="downloadProcessDoc2">Download Document</button>
                <button class="btn btn-primary mt-1" id="exportDiagram2">Export Diagram</button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">üìã README</h3>
              </div>
              <div class="card-body">
                <p class="text-muted mb-2">Export assignment README</p>
                <button class="btn btn-primary" id="exportReadme2">Export README</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // ========== Application State and Core Functionality ==========
    // All original functionality is preserved - only UI has been redesigned
    
    const state = {
      docs: {},
      index: null,
      selectedA: null,
      selectedB: null,
      bookmarksKey: 'pm_explorer_bookmarks_v1',
      scenarios: {},
      lastScenarioAction: 'none',
      currentDocId: null,
      currentPageIndex: 1
    };

    // Initialize search index
    function createIndex() {
      const idx = elasticlunr(function() {
        this.addField('title');
        this.addField('body');
        this.setRef('id');
      });
      state.index = idx;
    }
    createIndex();

    // PDF.js setup
    const pdfjsLib = window['pdfjs-dist/build/pdf'];
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.worker.min.js';

    // Utility functions
    function uid(prefix='d') { return prefix + '_' + Math.random().toString(36).slice(2,9); }
    function escapeHtml(s) { if(!s) return ''; return s.replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function short(s, n=160){ if(!s) return ''; return s.length>n? s.slice(0,n-1)+'‚Ä¶': s; }

    // ========== Page Navigation ==========
    document.querySelectorAll('.nav-item[data-page]').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        const pageId = this.getAttribute('data-page');
        
        // Update active nav item
        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
        this.classList.add('active');
        
        // Update page title
        const pageTitle = document.getElementById('currentPageTitle');
        pageTitle.textContent = this.querySelector('.nav-text').textContent;
        
        // Show selected page
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        
        // Special handling for viewer page
        if (pageId === 'viewer') {
          refreshDocSelect();
        }
      });
    });

    // Dashboard buttons navigation
    document.querySelectorAll('button[data-page]').forEach(button => {
      button.addEventListener('click', function() {
        const pageId = this.getAttribute('data-page');
        
        // Update active nav item
        document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
        document.querySelector(`.nav-item[data-page="${pageId}"]`).classList.add('active');
        
        // Update page title
        const pageTitle = document.getElementById('currentPageTitle');
        pageTitle.textContent = document.querySelector(`.nav-item[data-page="${pageId}"] .nav-text`).textContent;
        
        // Show selected page
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        
        // Special handling for viewer page
        if (pageId === 'viewer') {
          refreshDocSelect();
        }
      });
    });

    // ========== File Handling and Indexing ==========
    async function handleFiles(files) {
      for (const f of Array.from(files)) {
        const ext = f.name.split('.').pop().toLowerCase();
        const docId = uid(f.name.replace(/\W+/g,'_'));
        const doc = { id: docId, name: f.name, type: ext, pages: [], file: f };
        state.docs[docId] = doc;

        if (ext === 'pdf') {
          const arrayBuf = await f.arrayBuffer();
          const pdf = await pdfjsLib.getDocument({data: arrayBuf}).promise;
          for (let p=1;p<=pdf.numPages;p++){
            const page = await pdf.getPage(p);
            const txt = await page.getTextContent();
            const pageText = txt.items.map(i => i.str).join(' ');
            doc.pages.push({ page: p, text: pageText });
            state.index.addDoc({ id: `${docId}_p${p}`, title: `${f.name} ‚Äî page ${p}`, body: pageText, docId, page: p });
          }
        } else if (ext === 'txt' || ext === 'html' || ext === 'htm') {
          const text = await f.text();
          const chunks = chunkText(text, 800);
          chunks.forEach((c, i) => {
            const p = i+1;
            doc.pages.push({ page: p, text: c });
            state.index.addDoc({ id: `${docId}_p${p}`, title: `${f.name} ‚Äî page ${p}`, body: c, docId, page: p });
          });
        } else {
          const text = await f.text().catch(()=>'');
          doc.pages.push({ page: 1, text: text || `[Unable to extract text for ${f.name}]` });
          state.index.addDoc({ id: `${docId}_p1`, title: `${f.name} ‚Äî page 1`, body: doc.pages[0].text, docId, page: 1 });
        }
      }
      refreshDocList();
      refreshDocSelect();
      updateStats();
    }

    function chunkText(text, wordsPerChunk=800) {
      if (!text) return [''];
      const words = text.split(/\s+/);
      const out = [];
      for (let i=0;i<words.length;i+=wordsPerChunk) {
        out.push(words.slice(i,i+wordsPerChunk).join(' ').trim());
      }
      if(out.length===0) out.push(text);
      return out;
    }

    // ========== Document Viewer Functionality ==========
    function refreshDocSelect() {
      const select = document.getElementById('docSelect');
      select.innerHTML = '<option value="">-- Select a document --</option>';
      
      Object.keys(state.docs).forEach(id => {
        const d = state.docs[id];
        const opt = document.createElement('option');
        opt.value = id;
        opt.textContent = d.name;
        select.appendChild(opt);
      });
    }

    function openDoc(docId, page=1, highlightObj=null) {
      const doc = state.docs[docId];
      if(!doc) return;
      
      state.currentDocId = docId;
      state.currentPageIndex = Math.max(1, Math.min(page, doc.pages.length));
      
      document.getElementById('currentPage').textContent = `${state.currentPageIndex} / ${doc.pages.length}`;
      document.getElementById('docSelect').value = docId;
      
      renderPageContent(docId, state.currentPageIndex, highlightObj);
    }

    function renderPageContent(docId, pageNum, highlightObj=null) {
      const doc = state.docs[docId];
      if(!doc) return;
      
      const page = doc.pages.find(p=>p.page===pageNum);
      const el = document.getElementById('bookContent');
      
      if(!page) { 
        el.innerHTML = '<div class="text-muted text-center py-4">[page not found]</div>'; 
        return; 
      }
      
      let text = page.text || '[no text extracted]';
      
      if(highlightObj && highlightObj.q) {
        let start = typeof highlightObj.start === 'number' ? highlightObj.start : text.toLowerCase().indexOf(highlightObj.q.toLowerCase());
        if(start < 0) start = null;
        
        if(start !== null) {
          const end = typeof highlightObj.end === 'number' ? highlightObj.end : (start + highlightObj.q.length);
          const snipStart = Math.max(0, start - 300);
          const snipEnd = Math.min(text.length, end + 300);
          const snippet = text.slice(snipStart, snipEnd);
          const relStart = start - snipStart;
          const before = escapeHtml(snippet.slice(0, relStart));
          const mid = escapeHtml(snippet.slice(relStart, relStart + (end-start)));
          const after = escapeHtml(snippet.slice(relStart + (end-start)));
          
          el.innerHTML = before + `<mark>${mid}</mark>` + after;
          return;
        } else {
          const idx = text.toLowerCase().indexOf(highlightObj.q.toLowerCase());
          if(idx>=0){
            const start2 = Math.max(0, idx-80);
            const end2 = Math.min(text.length, idx + highlightObj.q.length + 80);
            const snippet = text.slice(start2, end2);
            const marked = snippet.replace(new RegExp(escapeRegExp(highlightObj.q),'i'), m=>`<mark>${escapeHtml(m)}</mark>`);
            el.innerHTML = marked;
            return;
          }
        }
      }
      
      el.textContent = text;
    }

    function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }

    // Document viewer event listeners
    document.getElementById('docSelect').addEventListener('change', (e) => {
      if(e.target.value) {
        openDoc(e.target.value, 1);
      }
    });

    document.getElementById('prevPage').addEventListener('click', () => {
      if(!state.currentDocId) return;
      openDoc(state.currentDocId, state.currentPageIndex - 1);
    });

    document.getElementById('nextPage').addEventListener('click', () => {
      if(!state.currentDocId) return;
      openDoc(state.currentDocId, state.currentPageIndex + 1);
    });

    // ========== UI Updates ==========
    function refreshDocList() {
      const fileList = document.getElementById('fileList');
      fileList.innerHTML = '';
      
      const keys = Object.keys(state.docs);
      if (keys.length === 0) {
        fileList.innerHTML = '<div class="text-muted text-center py-4">No documents uploaded yet</div>';
        return;
      }
      
      keys.forEach(id => {
        const d = state.docs[id];
        const div = document.createElement('div');
        div.className = 'result-item';
        div.innerHTML = `
          <div class="result-title">${escapeHtml(d.name)}</div>
          <div class="result-meta">${d.pages.length} pages ‚Ä¢ ${d.type.toUpperCase()}</div>
          <div class="d-flex gap-2 mt-2">
            <button class="btn btn-outline" data-doc="${id}" data-action="view">View</button>
            <button class="btn btn-outline" data-doc="${id}" data-action="setA">Set as A</button>
            <button class="btn btn-outline" data-doc="${id}" data-action="setB">Set as B</button>
          </div>
        `;
        fileList.appendChild(div);
      });

      // Add event listeners to buttons
      fileList.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', function() {
          const docId = this.getAttribute('data-doc');
          const action = this.getAttribute('data-action');
          
          if (action === 'setA') {
            setSelectionA({docId, pageNum: 1, excerpt: state.docs[docId].pages[0].text.slice(0, 300)});
          } else if (action === 'setB') {
            setSelectionB({docId, pageNum: 1, excerpt: state.docs[docId].pages[0].text.slice(0, 300)});
          } else if (action === 'view') {
            // Navigate to viewer page and open the document
            document.querySelector('.nav-item[data-page="viewer"]').click();
            openDoc(docId, 1);
          }
        });
      });
      
      updateStats();
    }

    function updateStats() {
      document.getElementById('docCount').textContent = Object.keys(state.docs).length;
      
      const bookmarks = loadBookmarks();
      document.getElementById('bookmarkCount').textContent = bookmarks.length;
    }

    // ========== Search Functionality ==========
    document.getElementById('searchBtn').addEventListener('click', doSearch);
    document.getElementById('searchBox').addEventListener('keydown', (e) => { 
      if(e.key === 'Enter') doSearch(); 
    });

    function doSearch(){
      const q = document.getElementById('searchBox').value.trim();
      const resDiv = document.getElementById('searchResults');
      resDiv.innerHTML = '';
      
      if(!q){ 
        resDiv.innerHTML = '<div class="text-muted text-center py-4">Enter a search term to find content across your standards</div>'; 
        return; 
      }

      let results = [];
      try {
        results = state.index.search(q, {
          fields: {
            title: { boost: 2 },
            body: { boost: 1 }
          },
          expand: true
        }).slice(0, 80);
      } catch(e){
        console.warn('elasticlunr search error', e);
        results = [];
      }

      if(!results || results.length === 0){
        const hits = [];
        const docs = state.index.documentStore.docs || {};
        for(const ref of Object.keys(docs)){
          const docRecord = state.index.documentStore.getDoc(ref);
          const body = (docRecord && docRecord.body) ? docRecord.body : '';
          if(body.toLowerCase().includes(q.toLowerCase())){
            hits.push({ ref, score: 0.1 });
          }
        }
        results = hits.slice(0,80);
      }

      if(!results || results.length === 0){
        resDiv.innerHTML = '<div class="text-muted text-center py-4">No results found</div>';
        return;
      }

      document.getElementById('searchCount').textContent = results.length;

      results.forEach(r => {
        const ref = r.ref;
        const docRecord = state.index.documentStore.getDoc(ref) || {};
        let docId = docRecord.docId;
        let pageNum = docRecord.page;
        
        if(!docId || !pageNum) {
          const m = ref.match(/^(.*)_p(\d+)$/);
          if(m) {
            docId = docId || m[1];
            pageNum = pageNum || parseInt(m[2], 10);
          } else {
            docId = docId || ref;
            pageNum = pageNum || 1;
          }
        }

        const doc = state.docs[docId];
        const page = doc ? doc.pages.find(p=>p.page===pageNum) : null;
        const text = page ? page.text : '';
        const snippet = findSnippet(text, q);
        
        const row = document.createElement('div');
        row.className = 'result-item';
        row.innerHTML = `
          <div class="result-title">${escapeHtml(doc ? doc.name : docId)}</div>
          <div class="result-meta">Page ${pageNum} ‚Ä¢ Score: ${r.score ? (typeof r.score === 'number' ? r.score.toFixed(2) : r.score) : '‚Äî'}</div>
          <div class="result-snippet">${escapeHtml(snippet)}</div>
          <div class="d-flex gap-2 mt-2">
            <button class="btn btn-outline" data-doc="${docId}" data-page="${pageNum}" data-q="${escapeHtml(q)}">View</button>
            <button class="btn btn-outline" data-doc="${docId}" data-page="${pageNum}" data-q="${escapeHtml(q)}" data-action="setA">Set as A</button>
            <button class="btn btn-outline" data-doc="${docId}" data-page="${pageNum}" data-q="${escapeHtml(q)}" data-action="setB">Set as B</button>
          </div>
        `;
        resDiv.appendChild(row);
      });

      // Add event listeners to result buttons
      resDiv.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', e => {
          const docId = e.target.getAttribute('data-doc');
          const pageNum = parseInt(e.target.getAttribute('data-page'), 10);
          const q = e.target.getAttribute('data-q');
          const action = e.target.getAttribute('data-action');
          
          if(action === 'setA') {
            setSelectionA({docId, pageNum, excerpt: q, q});
          } else if(action === 'setB') {
            setSelectionB({docId, pageNum, excerpt: q, q});
          } else {
            // Navigate to viewer and open the document with highlight
            document.querySelector('.nav-item[data-page="viewer"]').click();
            openDoc(docId, pageNum, {q});
          }
        });
      });
    }
